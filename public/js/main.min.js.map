{"version":3,"file":"main.min.js","sources":["main.js"],"sourcesContent":["import onReady from \"./modules/onReady.min.js\";\r\nimport showError from \"./modules/showError.min.js\";\r\n\r\nonReady(() => {\r\n  const pollForm = document.getElementById(\"get-poll-results-form\");\r\n  const postUrlInput = document.getElementById(\"post-url-input\");\r\n  const viewResultsBtn = document.getElementById(\"view-results-btn\");\r\n  const showExampleBtn = document.getElementById(\"show-example\");\r\n\r\n  showExampleBtn.addEventListener(\"click\", (ev) => {\r\n    ev.preventDefault();\r\n    postUrlInput.value = \"https://stefanbohacek.online/@stefan/111284206579024132\";\r\n    viewResultsBtn.focus();\r\n  });\r\n\r\n  pollForm.addEventListener(\"submit\", async (ev) => {\r\n    ev.preventDefault();\r\n    viewResultsBtn.disabled = true;\r\n\r\n    try {\r\n      let url = postUrlInput.value;\r\n      const urlParsed = new URL(url);\r\n\r\n      const platformDataRequest = await fetch(\r\n        `https://fediverse-info.stefanbohacek.dev/node-info?domain=${urlParsed.host}`\r\n      );\r\n\r\n      const platformData = await platformDataRequest.json();\r\n\r\n      console.log({\r\n        domain: urlParsed.host,\r\n        info: platformData,\r\n      });\r\n\r\n      const supportedPlatforms = [\"mastodon\"];\r\n      if (supportedPlatforms.includes(platformData?.software?.name)) {\r\n        window.location.href = `/poll?url=${encodeURIComponent(url)}`;\r\n      } else {\r\n        showError(\"not_supported\");\r\n      }\r\n    } catch (err) {\r\n      showError(\"general\");\r\n      console.log(\"poll_results_viewer_error:\", err);\r\n    }\r\n    viewResultsBtn.disabled = false;\r\n  });\r\n});\r\n"],"names":["onReady","showError","pollForm","document","getElementById","postUrlInput","viewResultsBtn","addEventListener","ev","preventDefault","value","focus","async","disabled","let","url","urlParsed","URL","platformData","await","fetch","host","json","console","log","domain","info","includes","software","name","window","location","href","encodeURIComponent","err"],"mappings":"OAAOA,YAAa,kCACbC,cAAe,6BAEtBD,QAAQ,KACN,IAAME,EAAWC,SAASC,eAAe,uBAAuB,EAChE,MAAMC,EAAeF,SAASC,eAAe,gBAAgB,EACvDE,EAAiBH,SAASC,eAAe,kBAAkB,EAC1CD,SAASC,eAAe,cAAc,EAE9CG,iBAAiB,QAAS,IACvCC,EAAGC,eAAe,EAClBJ,EAAaK,MAAQ,0DACrBJ,EAAeK,MAAM,CACvB,CAAC,EAEDT,EAASK,iBAAiB,SAAUK,MAAOJ,IACzCA,EAAGC,eAAe,EAClBH,EAAeO,SAAW,CAAA,EAE1B,IACEC,IAAIC,EAAMV,EAAaK,MACjBM,EAAY,IAAIC,IAAIF,CAAG,EAMvBG,EAAeC,MAJOA,MAAMC,MAChC,6DAA6DJ,EAAUK,IACzE,GAE+CC,KAAK,EAEpDC,QAAQC,IAAI,CACVC,OAAQT,EAAUK,KAClBK,KAAMR,CACR,CAAC,EAE0B,CAAC,YACLS,SAAST,GAAcU,UAAUC,IAAI,EAC1DC,OAAOC,SAASC,KAAO,aAAaC,mBAAmBlB,CAAG,EAE1Dd,UAAU,eAAe,CAK7B,CAHE,MAAOiC,GACPjC,UAAU,SAAS,EACnBsB,QAAQC,IAAI,6BAA8BU,CAAG,CAC/C,CACA5B,EAAeO,SAAW,CAAA,CAC5B,CAAC,CACH,CAAC"}