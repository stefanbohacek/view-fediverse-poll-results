{"version":3,"file":"main.min.js","sources":["main.js"],"sourcesContent":["import onReady from \"./modules/onReady.min.js\";\r\nimport showError from \"./modules/showError.min.js\";\r\n\r\nonReady(() => {\r\n  const pollForm = document.getElementById(\"get-poll-results-form\");\r\n  const postUrlInput = document.getElementById(\"post-url-input\");\r\n  const viewResultsBtn = document.getElementById(\"view-results-btn\");\r\n\r\n  pollForm.addEventListener(\"submit\", async (ev) => {\r\n    ev.preventDefault();\r\n    viewResultsBtn.disabled = true;\r\n\r\n    try {\r\n      let url = postUrlInput.value;\r\n      const urlParsed = new URL(url);\r\n\r\n      const platformDataRequest = await fetch(\r\n        `https://fediverse-info.stefanbohacek.dev/node-info?domain=${urlParsed.host}`\r\n      );\r\n\r\n      const platformData = await platformDataRequest.json();\r\n\r\n      console.log({\r\n        domain: urlParsed.host,\r\n        info: platformData,\r\n      });\r\n\r\n      const supportedPlatforms = [\"mastodon\"];\r\n      if (supportedPlatforms.includes(platformData?.software?.name)){\r\n          window.location.href = `/poll?url=${encodeURIComponent(url)}`;\r\n      } else {\r\n        showError('not_supported');\r\n      }\r\n    } catch (err) {\r\n    showError('general');\r\n      console.log(\"poll_results_viewer_error:\", err);\r\n    }\r\n    viewResultsBtn.disabled = false;\r\n  });\r\n});\r\n"],"names":["onReady","showError","pollForm","document","getElementById","postUrlInput","viewResultsBtn","addEventListener","async","ev","preventDefault","disabled","let","url","value","urlParsed","URL","platformData","await","fetch","host","json","console","log","domain","info","includes","software","name","window","location","href","encodeURIComponent","err"],"mappings":"OAAOA,YAAa,kCACbC,cAAe,6BAEtBD,QAAQ,KACN,IAAME,EAAWC,SAASC,eAAe,uBAAuB,EAChE,MAAMC,EAAeF,SAASC,eAAe,gBAAgB,EACvDE,EAAiBH,SAASC,eAAe,kBAAkB,EAEjEF,EAASK,iBAAiB,SAAUC,MAAOC,IACzCA,EAAGC,eAAe,EAClBJ,EAAeK,SAAW,CAAA,EAE1B,IACEC,IAAIC,EAAMR,EAAaS,MACjBC,EAAY,IAAIC,IAAIH,CAAG,EAMvBI,EAAeC,MAJOA,MAAMC,MAChC,6DAA6DJ,EAAUK,IACzE,GAE+CC,KAAK,EAEpDC,QAAQC,IAAI,CACVC,OAAQT,EAAUK,KAClBK,KAAMR,CACR,CAAC,EAE0B,CAAC,YACLS,SAAST,GAAcU,UAAUC,IAAI,EACxDC,OAAOC,SAASC,KAAO,aAAaC,mBAAmBnB,CAAG,EAE5DZ,UAAU,eAAe,CAK7B,CAHE,MAAOgC,GACThC,UAAU,SAAS,EACjBqB,QAAQC,IAAI,6BAA8BU,CAAG,CAC/C,CACA3B,EAAeK,SAAW,CAAA,CAC5B,CAAC,CACH,CAAC"}